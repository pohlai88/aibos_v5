<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-BOS Accounting - Banking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'apple-blue': '#007AFF',
                        'apple-green': '#34C759',
                        'apple-orange': '#FF9500',
                        'apple-red': '#FF3B30',
                        'apple-gray': '#8E8E93',
                        'apple-bg': '#F2F2F7',
                        'apple-card': '#FFFFFF',
                        'apple-border': '#E5E5EA'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-apple-bg min-h-screen">
    <!-- Navigation -->
    <nav class="bg-apple-card border-b border-apple-border shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-apple-blue">AI-BOS</h1>
                    </div>
                    <div class="hidden md:block ml-10">
                        <div class="flex items-baseline space-x-4">
                            <a href="index.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">Dashboard</a>
                            <a href="accounts.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">Chart of Accounts</a>
                            <a href="transactions.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">General Ledger</a>
                            <a href="ap-ar.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">AP/AR</a>
                            <a href="#" class="text-apple-blue border-b-2 border-apple-blue px-3 py-2 text-sm font-medium">Banking</a>
                            <a href="tax.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">Tax</a>
                            <a href="reports.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">Reports</a>
                            <a href="audit.html" class="text-gray-500 hover:text-apple-blue px-3 py-2 text-sm font-medium">Audit Trail</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-3xl font-bold text-gray-900">Banking & Reconciliation</h2>
                    <p class="text-gray-600 mt-2">Connect bank accounts and reconcile transactions</p>
                </div>
                <div class="flex space-x-3">
                    <button id="addBankAccountBtn" class="px-4 py-2 bg-apple-blue text-white rounded-lg hover:bg-blue-600 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Bank Account
                    </button>
                    <button id="syncAllBtn" class="px-4 py-2 bg-apple-green text-white rounded-lg hover:bg-green-600 transition-colors">
                        <i class="fas fa-sync mr-2"></i>Sync All
                    </button>
                </div>
            </div>
        </div>

        <!-- Bank Accounts Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Connected Accounts</p>
                        <p id="connectedAccounts" class="text-2xl font-bold text-gray-900">3</p>
                        <p class="text-sm text-apple-green mt-1">
                            <i class="fas fa-check-circle mr-1"></i>All synced
                        </p>
                    </div>
                    <div class="h-12 w-12 bg-apple-green/10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-university text-apple-green text-xl"></i>
                    </div>
                </div>
            </div>

            <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Pending Reconciliation</p>
                        <p id="pendingReconciliation" class="text-2xl font-bold text-apple-orange">15</p>
                        <p class="text-sm text-apple-orange mt-1">
                            <i class="fas fa-clock mr-1"></i>Transactions
                        </p>
                    </div>
                    <div class="h-12 w-12 bg-apple-orange/10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-balance-scale text-apple-orange text-xl"></i>
                    </div>
                </div>
            </div>

            <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Last Sync</p>
                        <p id="lastSync" class="text-2xl font-bold text-gray-900">2 hours ago</p>
                        <p class="text-sm text-apple-blue mt-1">
                            <i class="fas fa-sync mr-1"></i>Auto-sync enabled
                        </p>
                    </div>
                    <div class="h-12 w-12 bg-apple-blue/10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-clock text-apple-blue text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bank Accounts List -->
        <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Connected Bank Accounts</h3>
                <button id="manageConnectionsBtn" class="text-apple-blue text-sm font-medium hover:text-blue-600">
                    Manage Connections
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="flex items-center p-4 bg-green-50 rounded-lg">
                    <i class="fas fa-check-circle text-apple-green mr-3"></i>
                    <div class="flex-1">
                        <p class="text-sm font-medium">Chase Bank</p>
                        <p class="text-xs text-gray-600">****1234 • Last sync: 2 hours ago</p>
                    </div>
                    <button class="text-apple-blue hover:text-blue-600">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
                <div class="flex items-center p-4 bg-yellow-50 rounded-lg">
                    <i class="fas fa-exclamation-triangle text-apple-orange mr-3"></i>
                    <div class="flex-1">
                        <p class="text-sm font-medium">Wells Fargo</p>
                        <p class="text-xs text-gray-600">****5678 • Reconnection needed</p>
                    </div>
                    <button class="text-apple-orange hover:text-orange-600">
                        <i class="fas fa-refresh"></i>
                    </button>
                </div>
                <div class="flex items-center p-4 bg-gray-50 rounded-lg">
                    <i class="fas fa-plus text-gray-400 mr-3"></i>
                    <div class="flex-1">
                        <p class="text-sm font-medium">Add Bank Account</p>
                        <p class="text-xs text-gray-600">Connect another account</p>
                    </div>
                    <button class="text-apple-blue hover:text-blue-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Reconciliation Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Bank Transactions -->
            <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Bank Transactions</h3>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 text-xs bg-apple-blue text-white rounded-lg">All</button>
                        <button class="px-3 py-1 text-xs bg-gray-200 text-gray-700 rounded-lg">Unmatched</button>
                        <button class="px-3 py-1 text-xs bg-gray-200 text-gray-700 rounded-lg">Matched</button>
                    </div>
                </div>
                <div class="space-y-3 max-h-96 overflow-y-auto">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Office Supplies Purchase</p>
                            <p class="text-xs text-gray-600">Jan 15, 2024 • Chase Bank</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-red">-$150.00</p>
                            <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Unmatched</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Client Payment - ABC Corp</p>
                            <p class="text-xs text-gray-600">Jan 14, 2024 • Chase Bank</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-green">+$2,500.00</p>
                            <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Matched</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Monthly Rent Payment</p>
                            <p class="text-xs text-gray-600">Jan 13, 2024 • Wells Fargo</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-red">-$2,000.00</p>
                            <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Unmatched</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manual Transactions -->
            <div class="bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Manual Transactions</h3>
                    <button id="addManualTransactionBtn" class="text-apple-blue text-sm font-medium hover:text-blue-600">
                        <i class="fas fa-plus mr-1"></i>Add
                    </button>
                </div>
                <div class="space-y-3 max-h-96 overflow-y-auto">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Office Supplies</p>
                            <p class="text-xs text-gray-600">Jan 15, 2024 • Account: Office Supplies</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-red">-$150.00</p>
                            <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Unmatched</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Service Revenue - ABC Corp</p>
                            <p class="text-xs text-gray-600">Jan 14, 2024 • Account: Service Revenue</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-green">+$2,500.00</p>
                            <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Matched</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium">Rent Expense</p>
                            <p class="text-xs text-gray-600">Jan 13, 2024 • Account: Rent Expense</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-apple-red">-$2,000.00</p>
                            <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Unmatched</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reconciliation Actions -->
        <div class="mt-8 bg-apple-card rounded-xl shadow-sm border border-apple-border p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Reconciliation Actions</h3>
                <button id="autoMatchBtn" class="px-4 py-2 bg-apple-green text-white rounded-lg hover:bg-green-600 transition-colors">
                    <i class="fas fa-magic mr-2"></i>Auto-Match
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <button class="p-4 border border-apple-border rounded-lg hover:bg-gray-50 transition-colors text-left">
                    <div class="flex items-center">
                        <div class="h-8 w-8 bg-apple-blue/10 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-link text-apple-blue"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium">Match Transactions</p>
                            <p class="text-xs text-gray-600">Link bank and manual entries</p>
                        </div>
                    </div>
                </button>
                <button class="p-4 border border-apple-border rounded-lg hover:bg-gray-50 transition-colors text-left">
                    <div class="flex items-center">
                        <div class="h-8 w-8 bg-apple-orange/10 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-plus text-apple-orange"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium">Add Missing Entry</p>
                            <p class="text-xs text-gray-600">Create manual transaction</p>
                        </div>
                    </div>
                </button>
                <button class="p-4 border border-apple-border rounded-lg hover:bg-gray-50 transition-colors text-left">
                    <div class="flex items-center">
                        <div class="h-8 w-8 bg-apple-red/10 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-flag text-apple-red"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium">Flag for Review</p>
                            <p class="text-xs text-gray-600">Mark for later attention</p>
                        </div>
                    </div>
                </button>
                <button class="p-4 border border-apple-border rounded-lg hover:bg-gray-50 transition-colors text-left">
                    <div class="flex items-center">
                        <div class="h-8 w-8 bg-apple-green/10 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-check text-apple-green"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium">Complete Reconciliation</p>
                            <p class="text-xs text-gray-600">Finalize this period</p>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Add Bank Account Modal -->
    <div id="bankAccountModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 hidden">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-xl bg-apple-card">
            <div class="mt-3">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-900">Add Bank Account</h3>
                    <button id="closeBankModal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="bankAccountForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Bank Name</label>
                        <select id="bankName" required class="w-full px-3 py-2 border border-apple-border rounded-lg focus:outline-none focus:ring-2 focus:ring-apple-blue focus:border-transparent">
                            <option value="">Select Bank</option>
                            <option value="chase">Chase Bank</option>
                            <option value="wells_fargo">Wells Fargo</option>
                            <option value="bank_of_america">Bank of America</option>
                            <option value="citibank">Citibank</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Account Type</label>
                        <select id="accountType" required class="w-full px-3 py-2 border border-apple-border rounded-lg focus:outline-none focus:ring-2 focus:ring-apple-blue focus:border-transparent">
                            <option value="">Select Type</option>
                            <option value="checking">Checking</option>
                            <option value="savings">Savings</option>
                            <option value="credit">Credit Card</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Account Name</label>
                        <input type="text" id="accountName" required class="w-full px-3 py-2 border border-apple-border rounded-lg focus:outline-none focus:ring-2 focus:ring-apple-blue focus:border-transparent">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Last 4 Digits</label>
                        <input type="text" id="lastFourDigits" maxlength="4" class="w-full px-3 py-2 border border-apple-border rounded-lg focus:outline-none focus:ring-2 focus:ring-apple-blue focus:border-transparent">
                    </div>
                    <div class="mb-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="autoSync" checked class="rounded border-apple-border text-apple-blue focus:ring-apple-blue">
                            <span class="ml-2 text-sm text-gray-700">Enable auto-sync</span>
                        </label>
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="cancelBankAccount" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-apple-border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-apple-blue rounded-lg hover:bg-blue-600">
                            Add Account
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="database.js"></script>
    <script src="app.js"></script>
    <script>
        class BankingManagement {
            constructor() {
                this.bankAccounts = [];
                this.bankTransactions = [];
                this.manualTransactions = [];
                this.init();
            }

            async init() {
                await this.loadData();
                this.setupEventListeners();
                this.renderData();
            }

            async loadData() {
                // Mock data - would come from database
                this.bankAccounts = [
                    {
                        id: 1,
                        name: 'Chase Bank',
                        accountType: 'checking',
                        lastFourDigits: '1234',
                        status: 'connected',
                        lastSync: '2 hours ago'
                    },
                    {
                        id: 2,
                        name: 'Wells Fargo',
                        accountType: 'savings',
                        lastFourDigits: '5678',
                        status: 'disconnected',
                        lastSync: '3 days ago'
                    }
                ];

                this.bankTransactions = [
                    {
                        id: 1,
                        description: 'Office Supplies Purchase',
                        date: '2024-01-15',
                        amount: -150,
                        bank: 'Chase Bank',
                        status: 'unmatched'
                    },
                    {
                        id: 2,
                        description: 'Client Payment - ABC Corp',
                        date: '2024-01-14',
                        amount: 2500,
                        bank: 'Chase Bank',
                        status: 'matched'
                    }
                ];

                this.manualTransactions = [
                    {
                        id: 1,
                        description: 'Office Supplies',
                        date: '2024-01-15',
                        amount: -150,
                        account: 'Office Supplies',
                        status: 'unmatched'
                    },
                    {
                        id: 2,
                        description: 'Service Revenue - ABC Corp',
                        date: '2024-01-14',
                        amount: 2500,
                        account: 'Service Revenue',
                        status: 'matched'
                    }
                ];
            }

            setupEventListeners() {
                document.getElementById('addBankAccountBtn').addEventListener('click', () => this.showBankModal());
                document.getElementById('closeBankModal').addEventListener('click', () => this.hideBankModal());
                document.getElementById('cancelBankAccount').addEventListener('click', () => this.hideBankModal());
                document.getElementById('bankAccountForm').addEventListener('submit', (e) => this.handleBankAccountSubmit(e));
                document.getElementById('syncAllBtn').addEventListener('click', () => this.syncAllAccounts());
                document.getElementById('autoMatchBtn').addEventListener('click', () => this.autoMatchTransactions());
            }

            renderData() {
                this.updateSummaryCards();
                this.renderBankAccounts();
            }

            updateSummaryCards() {
                document.getElementById('connectedAccounts').textContent = this.bankAccounts.filter(acc => acc.status === 'connected').length;
                document.getElementById('pendingReconciliation').textContent = this.bankTransactions.filter(t => t.status === 'unmatched').length;
                document.getElementById('lastSync').textContent = '2 hours ago';
            }

            renderBankAccounts() {
                // Bank accounts are rendered in the HTML template
            }

            showBankModal() {
                document.getElementById('bankAccountModal').classList.remove('hidden');
            }

            hideBankModal() {
                document.getElementById('bankAccountModal').classList.add('hidden');
                document.getElementById('bankAccountForm').reset();
            }

            async handleBankAccountSubmit(e) {
                e.preventDefault();
                const formData = {
                    name: document.getElementById('bankName').value,
                    accountType: document.getElementById('accountType').value,
                    accountName: document.getElementById('accountName').value,
                    lastFourDigits: document.getElementById('lastFourDigits').value,
                    autoSync: document.getElementById('autoSync').checked
                };

                // Add to bank accounts array
                this.bankAccounts.push({
                    id: this.bankAccounts.length + 1,
                    ...formData,
                    status: 'connected',
                    lastSync: 'Just now'
                });

                this.hideBankModal();
                this.renderData();
                alert('Bank account added successfully!');
            }

            async syncAllAccounts() {
                const connectedAccounts = this.bankAccounts.filter(acc => acc.status === 'connected');
                alert(`Syncing ${connectedAccounts.length} bank accounts...`);
                
                // Simulate sync process
                setTimeout(() => {
                    alert('All accounts synced successfully!');
                    this.renderData();
                }, 2000);
            }

            async autoMatchTransactions() {
                const unmatchedBank = this.bankTransactions.filter(t => t.status === 'unmatched');
                const unmatchedManual = this.manualTransactions.filter(t => t.status === 'unmatched');
                
                alert(`Auto-matching ${unmatchedBank.length} bank transactions with ${unmatchedManual.length} manual entries...`);
                
                // Simulate matching process
                setTimeout(() => {
                    alert('Auto-matching completed! 3 transactions matched.');
                    this.renderData();
                }, 1500);
            }
        }

        // Initialize when page loads
        let bankingManagement;
        document.addEventListener('DOMContentLoaded', function() {
            bankingManagement = new BankingManagement();
        });
    </script>
</body>
</html> 